define("common/confirm/confirm.js",function(require,exports,module){var template=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="confirm-dialog" style="position:absolute;">\n    <a class="close" data-node="close">\n        <i class="icon icon-close"></i>\n    </a>\n    <div class="confirm-inner" data-node="inner">\n    </div>\n    <div class="btn-group">\n        <div class="btn cancel" data-node="cancel">取消</div>\n        <div class="btn" data-node="ok">确认</div>\n    </div>\n</div>';return __p},mask='<div class="mask"></div>',instanceObj=null,Confirm=function(){this.$el=$(template()),this.$mask=$(mask),this.$inner=this.$el.find('[data-node="inner"]'),this.inDom=!1,this.bindEvent()};Confirm.prototype={bindEvent:function(){this.$el.on("click",'[data-node="close"]',$.proxy(this.hide,this)),this.$el.on("click",'[data-node="cancel"]',$.proxy(this.onCancelClick,this)),this.$el.on("click",'[data-node="ok"]',$.proxy(this.onOkClick,this))},show:function(i){var n=$(window);this.curSpec=i||{},this.inDom||(this.$el.appendTo("body"),this.$mask.appendTo("body"),this.inDom=!0),this.$inner.html(this.curSpec.text||"确认执行当前操作？"),this.$el.show(),this.$mask.show(),this.$el.css({left:n.scrollLeft()+(n.width()-this.$el.width())/2,top:n.scrollTop()+(n.height()-this.$el.height())/2})},hide:function(){this.$el.hide(),this.$mask.hide()},onCancelClick:function(){this.hide()},onOkClick:function(){"function"==typeof this.curSpec.success&&this.curSpec.success(),this.hide()}},module.exports=function(){return instanceObj||(instanceObj=new Confirm),instanceObj}});
;define("common/feedbackDialog/feedbackDialog.js",function(require,exports,module){var template=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="dialog feedback_dialog" style="position:fixed;">\n    <div class="dialog-header">\n        <h3>意见反馈</h3>\n    </div>\n    <div class="dialog-inner" data-node="inner">\n        <div class="feedback_panel">\n            <form>\n                <ul>\n                    <li>\n                        <p class="label">联系方式（必填）</p>\n                        <div class="input-group">\n                            <input class="email" placeholder="您的邮箱/QQ号" type="text" name="feedback-email">\n                        </div>\n                    </li>\n                    <li>\n                        <p class="label">您的意见（必填）</p>\n                        <div class="input-group">\n                            <textarea style="height:100px;" name="feedback-content" class="content" maxlength="140" placeholder="请填写您的意见，不超过140字"></textarea>\n                        </div>\n                    </li>\n                    <li>\n                        <div class="input-group">\n                            <input type="submit" class="submit-btn" value="提交">\n                            <span class="msg" data-node="msg"></span>\n                            <a data-node="close" class="close" href="javascript:;">[关闭]</a>\n                        </div>\n                    </li>\n                </ul>\n            </form>\n        </div>\n    </div>\n</div>';return __p},instanceObj=null,MESSAGE={success:"已提交,感谢您的意见",fail:"提交错误,请稍后重试",mail_error:"请输入正确的联系方式",content_error:"请输入您的意见",content_length_error:"意见长度超出限制"},MAX_LENGTH=280,FeedbackDialog=function(){this.$el=$(template()),this.$el.appendTo("body"),this.$email=this.$el.find('[name="feedback-email"]'),this.$content=this.$el.find('[name="feedback-content"]'),this.$msg=this.$el.find('[data-node="msg"]'),this.showing=!1,this.bindEvent()};FeedbackDialog.prototype={bindEvent:function(){this.$el.on("click",'[data-node="close"]',$.proxy(this.hide,this)),this.$el.on("submit","form",$.proxy(this.onFormSubmit,this))},showMsg:function(e){this.msgTimer&&clearTimeout(this.msgTimer);var t="success"!==e?"addClass":"removeClass";this.$msg[t]("error"),this.$msg.html(MESSAGE[e]),this.$msg.show();var i=this;this.msgTimer=setTimeout(function(){i.$msg.hide(),i.$msg.html("")},2e3)},show:function(){if(!this.showing){this.showing=!0;{$(window)}this.$el.show(),this.$el.animate({right:0},200)}},hide:function(){var e=this;this.$el.animate({right:-362},200,function(){e.$el.hide()}),this.showing=!1},onFormSubmit:function(e){e.preventDefault();var t=($(e.currentTarget),$.trim(this.$email.val())),i=$.trim(this.$content.val());return t.length<5?(this.$email.focus(),this.showMsg("mail_error")):!i||i.length>MAX_LENGTH?(this.$content.focus(),this.showMsg(i?"content_length_error":"content_error")):void $.ajax({url:"/post_message/",type:"POST",dataType:"json",data:{appkey:"web",uuid:t,content:"["+window.location.host+"]"+i},context:this,success:function(e){var t=this;return e=e||{},"success"!==e.message?this.showMsg("fail"):(this.showMsg("success"),this.$email.val(""),this.$content.val(""),void setTimeout(function(){t.hide()},2e3))}})}},module.exports=function(){return instanceObj||(instanceObj=new FeedbackDialog),instanceObj}});
;define("common/util/user.js",function(e,t,o){var n="/auth/login/",r="/user/info/",c="/auth/connect/?type=toutiao&platform=",i=null,s=!1,u="",a=function(e){if(e=e||{},!s){s=!0;var t=e.successCb||function(){},o=e.errorCb||function(){};$.ajax({url:n,type:"POST",dataType:"json",context:this,data:e.data,success:function(e){return s=!1,e=e||{},"success"!==e.message?o(e):(i=e.user,t(i),void listener.trigger("com.toutiao.user","change",i))},error:function(){s=!1,o({})}})}},f=function(e,t){var o=610,n=505,r=c+e,i=Math.max((window.screen.width-o)/2,0),s=Math.max((window.screen.height-n)/2,0),u="location=0,toolbar=0,status=0,resizable=0,scrollbars=1,width=610,height=505,top="+s+",left="+i,a=window.open(r,"login",u);try{a.focus()}catch(f){}l(a,t)},l=function(e,t){var o=!0;try{o=e.closed}catch(n){}o?(clearTimeout(arguments.callee.timer),g(t)):u=setTimeout(function(){l(e,t)},1e3)},g=function(e){e=e||{};var t=e.successCb||function(){},o=e.errorCb||function(){},n=$.cookie("sessionid");n?n&&i?t(i):h(e):o()},h=function(e){e=e||{};var t=e.successCb||function(){},o=e.errorCb||function(){};$.ajax({url:r,type:"get",cache:!1,dataType:"json",success:function(e){return e=e||{},"error"===e.message?o(e):(i=e,t(i),void listener.trigger("com.toutiao.user","change",i))},error:function(){o({})}})};o.exports={checkLogin:g,getUserInfo:h,loginByLoc:a,loginByOther:f}});
;define("common/loginDialog/loginDialog.js",function(require,exports,module){var user=require("common/util/user.js"),template=function(obj){{var __p="";Array.prototype.join}with(obj||{})__p+='<div class="login-dialog" style="position:absolute;">\n    <a class="btn" data-node="close">\n        <i class="icon icon-close"></i>\n    </a>\n    <div class="login-dialog-header">\n        <h3>邮箱登录</h3>\n    </div>\n    <div class="login-dialog-inner" data-node="inner">\n        <div class="login-pannel bottom-line">\n            <form data-node="loginForm" action="/auth/login/" method="POST">\n                <ul>\n                    <li>\n                        <div class="input-group">\n                            <div class="input">\n                                <label>邮箱</label>\n                                <input class="name" name="name_or_email" type="text" placeholder="请使用您的注册邮箱" autocomplete="off" spellcheck="false">\n                            </div>\n                        </div>\n                    </li>\n                    <li>\n                        <div class="input-group">\n                            <div class="input">\n                                <label>密码</label>\n                                <input class="password" name="password" type="password" data-node="password" placeholder="密码" autocomplete="off" spellcheck="false">\n                            </div>\n                        </div>\n                    </li>\n                    <li data-node="captchaBox" class="captcha-box">\n                        <div class="input-group">\n                            <div class="input">\n                                <input class="password" name="captcha" type="text" data-node="captcha" placeholder="验证码" autocomplete="off" spellcheck="false">\n                                <img data-node="captchaImg"/>\n                            </div>\n                        </div>\n                    </li>\n                    <li>\n                        <div class="input-group">\n                            <input type="checkbox" name="remember_me" checked="" style="vertical-align:top">\n                            <label for="remember_me" class="label">记住账号</label>\n                        </div>\n                    </li>\n                    <li>\n                        <div class="input-group" style="text-align: center;">\n                            <input type="submit" class="submit-btn" value="登录">\n                            <p class="error" data-node="errorMsg"></p>\n                        </div>\n                    </li>\n                </ul>\n            </form>\n        </div>\n        <div class="login-dialog-header">\n            <h3>合作网站帐号登陆</h3>\n        </div>\n        <div class="login-pannel">\n            <ul class="sns_login_list clearfix">\n                <li class="sinaweibo">\n                    <a href="javascript:;" data-node="snsLogin" data-pid="sina_weibo">\n                        <i class="icon"></i>\n                        新浪微博\n                    </a>\n                </li>\n                <li class="qzone">\n                    <a href="javascript:;" data-node="snsLogin" data-pid="qzone_sns">\n                        <i class="icon"></i>\n                        QQ空间\n                    </a>\n                </li>\n                <li class="renren">\n                    <a href="javascript:;" data-node="snsLogin" data-pid="renren_sns">\n                        <i class="icon"></i>\n                        人人网\n                    </a>\n                </li>\n                <li class="qqweibo">\n                    <a style="margin-right:0;" href="javascript:;" data-node="snsLogin" data-pid="qq_weibo">\n                        <i class="icon"></i>\n                        腾讯微博\n                    </a>\n                </li>\n            </ul>\n        </div>\n    </div>\n</div>';return __p},mask='<div class="mask"></div>',instanceObj=null,LoginDialog=function(){this.$el=$(template()),this.$pwd=this.$el.find('[data-node="password"]'),this.$errorMsg=this.$el.find('[data-node="errorMsg"]'),this.$captchaBox=this.$el.find('[data-node="captchaBox"]'),this.$captchaImg=this.$el.find('[data-node="captchaImg"]'),this.$captcha=this.$el.find('[data-node="captcha"]'),this.$form=this.$el.find(""),this.$mask=$(mask),this.curUser=null,this.bindEvent(),this.inDom=!1};LoginDialog.prototype={bindEvent:function(){this.$el.on("submit",'[data-node="loginForm"]',$.proxy(this.onFormSubmit,this)),this.$el.on("click",'[data-node="snsLogin"]',$.proxy(this.onSnsLoginClick,this)),this.$el.on("click",'[data-node="close"]',$.proxy(this.hide,this))},showError:function(n){var i=this;this.errorMsgTimer&&clearTimeout(this.errorMsgTimer),this.$errorMsg.html(n),this.$errorMsg.show(),this.errorMsgTimer=setTimeout(function(){i.$errorMsg.hide(),i.$errorMsg.html("")},2e3)},show:function(n){var i=$(window);this.curSpec=n||{},this.inDom||(this.$el.appendTo("body"),this.$mask.appendTo("body"),this.inDom=!0),this.$el.show(),this.$mask.show(),this.$el.css({left:i.scrollLeft()+(i.width()-this.$el.width())/2,top:i.scrollTop()+(i.height()-this.$el.height())/2})},hide:function(){this.$el.hide(),this.$mask.hide()},onFormSubmit:function(n){if(n.preventDefault(),!this.locked){this.locked=!0;var i=$(n.currentTarget),a=i.serialize(),s=this;user.loginByLoc({data:a,successCb:function(n){s.locked=!1,"function"==typeof s.curSpec.successCb&&s.curSpec.successCb(n)},errorCb:function(n){s.locked=!1,s.$pwd.val(""),n=n||{};var i=n.data||{};s.showError(i.description||"登陆失败"),i.captcha?(s.$captcha.val(""),s.$captchaImg.attr("src","data:image/gif;base64,"+i.captcha),s.$captchaBox.show()):(s.$captcha.val(""),s.$captchaBox.hide()),"function"==typeof s.curSpec.errorCb&&s.curSpec.errorCb(n)}})}},onSnsLoginClick:function(n){var i=$(n.currentTarget),a=i.data("pid");this.hide(),user.loginByOther(a,this.curSpec)}},module.exports=function(){return instanceObj||(instanceObj=new LoginDialog),instanceObj}});
;define("common/util/bdshare.js",function(t,e,n){var o="6649976",i="http://s.share.baidu.com/",a=function(){var t=(new Date).getTime(),e=(new Date).getTime()+1e3,n=(new Date).getTime()+3e3;return t.toString(32)+e.toString(32)+n.toString(32)},r=function(t,e){for(var n=t.length,o="",i=1;e>=i;i++){var a=Math.floor(n*Math.random());o+=t.charAt(a)}return o},c=function(){var t=(new Date).toString(36),e=r("0123456789abcdefghijklmnopqrstuvwxyz",3);return t+e};n.exports=function(t,e){e=$.extend(e||{});var n=a(),r=0,l="",u=document.title,d=e.wbuid||"",m=c(),s=(window.isAppPage?"app":"detail/list",encodeURIComponent(e.pic||"")),p=encodeURIComponent(e.url||""),h=encodeURIComponent(e.comment||""),f=encodeURIComponent(e.desc||"");"tsina"===t?u=(e.text||u)+(e.weibotext||l):("tqq"===t&&(e.text=e.text.replace("@今日头条","@headlineapp")),u=e.text||u),u=encodeURIComponent(u.substring(0,300));var g="?click=1&url="+p+"&uid="+o+"&to="+t+"&type=text&relateUid="+d+"&pic="+s+"&title="+u+"&key=&sign=on&desc="+f+"&comment="+h+"&searchPic=0&l="+n+"&linkid="+m+"&sloc=&apiType=0&buttonType="+r,w=i+g,b=i+"commit"+g+"&t="+Math.random(),v=function(){var t=[];return function(e){var n=t.push(new Image)-1;t[n].onload=function(){t[n]=t[n].onload=null},t[n].src=e}}();setTimeout(function(){v(b)},1500),window.open(w,"_blank","height=500,width=700,left=0,toolbar=no,menubar=no,scrollbars=no,resizable=no,location=no,status=no")}});
;define("common/util/dateFormat.js",function(e,t,n){n.exports=function(e,t){var n,g={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(n in g)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?g[n]:("00"+g[n]).substr((""+g[n]).length)));return t}});
;define("common/util/storage.js",function(e,t,n){var o=window.localStorage,r=function(e){return null===e||"undefined"==typeof e?e:decodeURIComponent(e)};if(o)return{get:function(e){return r(o.getItem(e))},set:function(e,t){o.setItem(e,encodeURIComponent(t))},del:function(e){o.removeItem(e)},clear:function(){o.clear()},getAll:function(){for(var e=o.length,t=null,n=[],r=0;e>r;r++)t=o.key(r),n.push(t+"="+this.getKey(t));return n.join("; ")}};if(window.ActiveXObject){var i=document.documentElement,c="localstorage";try{i.addBehavior("#default#userdata"),i.save("localstorage")}catch(u){}return{set:function(e,t){i.setAttribute(e,t),i.save(c)},get:function(e){return i.load(c),i.getAttribute(e)},del:function(e){i.removeAttribute(e),i.save(c)}}}return{get:function(e){for(var t=document.cookie.split("; "),n=t.length,o=[],i=0;n>i;i++)if(o=t[i].split("="),e===o[0])return r(o[1]);return null},set:function(e,t,n){n&&"object"==typeof n||(n=new Date,n.setDate(n.getDate()+1)),document.cookie=e+"="+encodeURIComponent(t)+"; expires="+n.toGMTString()},del:function(e){document.cookie=e+"=''; expires=Fri, 31 Dec 1999 23:59:59 GMT;"},clear:function(){for(var e=document.cookie.split("; "),t=e.length,n=[],o=0;t>o;o++)n=e[o].split("="),this.deleteKey(n[0])},getAll:function(){return r(document.cookie.toString())}}});
;define("pagelet/nav/nav.js",function(require,exports,module){var loginDialog=require("common/loginDialog/loginDialog.js"),userTmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<a class="btn user-head" href="//web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/pin/">\n    <img src="'+(null==(__t=avatar_url)?"":__t)+'">\n    <span>'+(null==(__t=name)?"":__t)+'</span>\n</a>\n<i class="line"></i>\n<div class="layer">\n    <ul>\n        <li><a ga_event="nav_my_pin" href="//web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/pin/" class="layer-item">我的收藏</a></li>\n        <li><a ga_event="nav_my_message" href="//web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/subscribe/" class="layer-item">我的订阅</a></li>\n        <li><a ga_event="nav_my_message" href="//web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/followers/" class="layer-item">我的粉丝</a></li>\n        <li><a ga_event="nav_my_message" href="//web.toutiao.com/user/'+(null==(__t=user_id)?"":__t)+'/followings/" class="layer-item">我的关注</a></li>\n        <li><a href="//web.toutiao.com/auth/logout/" class="layer-item">退出</a></li>\n    </ul>\n</div>';return __p};module.exports=Pagelet.extend({el:"#pagelet-nav",hasHotwords:!1,events:{"mouseenter $username":"showLayer","mouseenter $more":"showLayer","mouseleave $username":"hideLayer","mouseleave $more":"hideLayer","click $login":"onLoginClick"},channels:{"com.toutiao.user change":"onUserChange"},init:function(e){this.spec=e||{};var o=this.spec.type||"";this.$dom[o]&&this.$dom[o].addClass("selected"),"#login"===window.location.hash&&loginDialog().show({successCb:function(){window.location.reload()}})},showLayer:function(e){var o=this,a=$(e.currentTarget),i=a.data("node"),t=i+"hidetimer",n=i+"showtimer";this[t]&&clearTimeout(this[t]),this[n]=setTimeout(function(){o.$dom[i].addClass("show-layer")},300)},hideLayer:function(e){var o=this,a=$(e.currentTarget),i=a.data("node"),t=i+"hidetimer",n=i+"showtimer";this[n]&&clearTimeout(this[n]),this[t]=setTimeout(function(){o.$dom[i].removeClass("show-layer")},100)},onLoginClick:function(){loginDialog().show({successCb:function(){window.location.reload()}})},onUserChange:function(e,o){this.$dom.username.html(userTmpl(o))}})});
;define("pagelet/feedback/feedback.js",function(i,o,n){var e=i("common/feedbackDialog/feedbackDialog.js");n.exports=Pagelet.extend({el:"#pagelet-feedback",events:{"click $back":"onBackClick","click $feedback":"onFeedbackClick"},init:function(){var i=this;this.showing=!1,this.$win=$(window),this.fbDialog=e(),$(document).on("click",function(){i.fbDialog.hide()}),this.fbDialog.$el.on("click",function(i){i.stopPropagation()});var o,n;this.$win.on("scroll",function(){o=i.$win.scrollTop(),n=i.$win.height(),!i.showing&&o>n?(i.$el.show(),i.showing=!0):i.showing&&n>=o&&(i.$el.hide(),i.showing=!1)})},onBackClick:function(){window.scrollTo(0,0)},onFeedbackClick:function(i){i.stopPropagation(),this.fbDialog.showing?this.fbDialog.hide():this.fbDialog.show()}})});